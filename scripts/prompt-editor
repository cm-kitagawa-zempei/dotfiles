#!/usr/bin/env bash
set -euo pipefail

# プロンプトエディタスクリプト
# Alt-eでHelixを開き、編集内容を元のペインに送信する

# 一時ファイルを作成
TMPFILE=$(mktemp /tmp/claude-prompt-$$.cprompt)
trap "rm -f $TMPFILE" EXIT

# Helixを開く
hx "$TMPFILE"

# ファイルが空でなければClaude Codeに送信
if [ -s "$TMPFILE" ]; then
  # フローティングペインを閉じて元のペインにフォーカス
  zellij action toggle-floating-panes
  sleep 0.1
  # 元のペインに内容を送信
  zellij action write-chars -- "$(cat "$TMPFILE") "
fi

# 一時ファイルの削除
rm -f "$TMPFILE"
